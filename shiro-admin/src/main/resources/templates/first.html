<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="/assets/css/reset.css">
	<link rel="stylesheet" href="/assets/js/css/layui.css">
<link rel="stylesheet" type="text/css" href="/assets/css/first.css">
<link rel="stylesheet" type="text/css" href="/assets/css/index.css">
<script type="text/javascript" src="/assets/js/clock.js"></script>
<title></title>
</head>

<body onload="start();">
	<div class="first_box">
		<div class="first_box_left">
			<div class="iframe_box">
				<div class="iframe_left file_iframe_left">
					<div class="iframe_left_list">
						<li>搜索</li>
						<li>搜索结果</li>
					</div>
				</div>

				<div class="right-iframe">

					<div class="layui-row">
						<div class="layui-container">
							<div class="title"><i class="layui-icon layui-icon-search"></i> 档案库内检索</div>
							<p class="tips">制定<span class="red-font">【档案库】</span><span class="red-font">【档案库】</span><span
									class="red-font">【查询值】</span>查找档案信息。或使用高级检索</p>

							<form class="layui-form" id="search_form">

								<div class="layui-form-item">
									<div class="layui-input-inline" id="keys">
										<select name="keys">
											<option value="file_number">档号</option>
											<option value="fond_name">全宗名称</option>
											<option value="file_title">文件标题</option>
											<option value="category_name">分类名称</option>
											<option value="file_category">档案类别</option>
											<option value="storage_periodCode">保管期限代码</option>
											<option value="secret_level">密级</option>
											<option value="organization">组织机构</option>
											<option value="remarks">备注</option>
											<option value="storage_location">存放位置</option>
											<option value="license_number">登记号</option>
											<option value="carriers_number">载体数量</option>
											<option value="fond_number">全宗号</option>
											<option value="files_number">案卷号</option>
											<option value="box_number">盒号</option>
											<option value="annex">附件</option>
											<option value="problem">问题</option>
											<option value="storage_time">保管期限</option>
											<option value="category_number">分类号</option>
										</select>
									</div>
									<div class="layui-input-inline" id="isInclude">
										<select name="isInclude">
											<option value="0">包含</option>
											<option value="1">等于</option>
											<option value="2">不包含</option>
										</select>
									</div>
									<div class="layui-input-inline" id="keyValue">
										<input type="text" name="keyValue" class="layui-input" placeholder="请输入关键词">
									</div>
									<div class="layui-input-inline">
										<button class="layui-btn red-bg" id="direct_search">直接检索</button>
										<button class="layui-btn red-bg" id="add_condition">添加条件</button>
									</div>
								</div>
							</form>

							<p class="tips">请选择档案库字段和运算条件、调价关键词后，点击
								<span class="red-font">直接检索</span>可单条件查询，点击
								<span class="red-font">添加条件</span>
								加入下方条件域后可多条件查询
							</p>


							<div class="layui-customer-height">
								<div class="layui-form multi-form">
									<div class="layui-form-item layui-form-text">
										<div class="layui-input-inline multi-input">
											<textarea name="desc" id="textarea_main" placeholder="请输入内容" disabled
													  class="layui-textarea"></textarea>
										</div>
										<div class="layui-input-inline multi-input-button">
											<button class="customer-button" id="button__and">并且</button>
											<button class="customer-button" id="button__or">或者</button>
											<button class="customer-button" id="button__not">非</button>
											<button class="customer-button" id="button__left">(</button>
											<button class="customer-button" id="button__right">)</button>
										</div>
									</div>
									<div class="layui-form-item">
										<button class="customer-button-2" id="empty">清空条件</button>
										<button class="customer-button-2" id="delete_last">删除末项</button>
										<button class="layui-btn red-bg" style="float: right;" id="multi_search">多条件检索</button>
									</div>
								</div>

							</div>
						</div>

					</div>

				</div>

				<div class="right-iframe">
					<table class="layui-hide" id="test" lay-filter="test"></table>
				</div>
			</div>
		</div>
		<div class="first_box_right">
			<div class="box_right_top">
				<div class="notice">操作记录</div>
				<div class="notice_content">
					<ul>

					</ul>
				</div>
			</div>
			<div class="box_right_mid">
				<div id="time_box"></div>
				<div id="date_box"></div>
			</div>
			<div class="box_right_btm">
				<div class="statistics_box">
					<div class="statistics_num">
						<div class="statistics_img statistics_img1"></div>
						<p><span class="color_red" name="file"></span><span>件</span> </p>
					</div>
					<div class="statistics_num">
						<div class="statistics_img statistics_img2"></div>
						<p><span class="color_red" name="ele"></span><span>个</span> </p>
					</div>
					<div class="statistics_num">
						<div class="statistics_img statistics_img3"></div>
						<p><span class="color_red" name="case"></span><span>卷</span> </p>
					</div>
				</div>
			</div>
		</div>
		<div class="clear"></div>
	</div>
</body>
<!-- 搜索结果表格头部工具栏 -->
<script type="text/html" id="toolbarDemo">
	<div>
		搜索：
		<div class="layui-inline custom_width_100">
			<input class="layui-input" name="id" id="test_Reload__input" autocomplete="off">
		</div>
		<button class="layui-btn layui-btn-radius layui-btn-normal" lay-event="search_Test" data-type="reload">
			<i class="layui-icon">&#xe615;</i>
		</button>
		<button class="layui-btn layui-btn-sm" lay-event="showAll">显示全部</button>
	</div>
</script>
<script type="text/javascript" src='/assets/js/jquery-3.5.1.min.js'></script>
<script type="text/javascript" src="/assets/js/clock.js"></script>
<script type="text/javascript" src='/assets/js/tooles.js'></script>
<script>
	window.onload=function(){start()};
</script>
<script type="text/javascript">
	$(".search_btn").click(function(){
		let param = $("input[name='search']").val();
		if(!param){
			alert("检索参数不能为空！");
		}
		$(location).attr('href','/mangers?param='+param);
	})
	count();
	log();
	function count(){
		$.ajax({
			type: "GET",
			url: "/file/count",
			dataType: "json",
			success: function (json) {
				console.log(json);
				if (json.status === 200) {
					$("span[name='ele']").html(json.data.eleNumber);
					$("span[name='file']").html(json.data.fileNumber);
					$("span[name='case']").html(json.data.caseNumber);
				}
			}
		});
	}
	function log(){
		$.ajax({
			type: "GET",
			url: "/log/condit",
			data:{"pageNumber":1,"keywords":""},
			dataType: "json",
			async:false,
			success: function (json) {
				let rows = json.rows;
				length = json.total;
				let tbody = $(".notice_content ul");
				tbody.html("");
				let content = ``;
				let ser = 1;
				for(let row of rows){
					if(ser>=4)
						break;
					content+=`<li><span>`+row.content+`</span> <span class="notice_time">`+renderTime(row.createTime)+`</span></li>`;
					ser++;
				}
				tbody.html(content);
			}
		});
	}
</script>

<script src="/assets/js/layui.js"></script>
<script src="/assets/js/search/search.js?v=2"></script>
<script src="/assets/js/search/result_table.js"></script>

</html>
